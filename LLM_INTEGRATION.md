# LLM 分析整合說明

## 概述

本項目已成功整合 Qwen2.5:0.5b 模型進行文章分析，提供更智能和準確的投資標的推薦。

## 技術架構

### 1. 模型選擇
- **模型**: Qwen2.5:0.5b (397MB)
- **運行環境**: Ollama
- **特點**: 輕量級、快速響應、中文支持良好

### 2. 整合方式
- 使用 `ollama` Python 客戶端
- 通過 HTTP API 與 Ollama 服務通信
- 保留規則式分析作為備用方案

## 功能特點

### LLM 分析輸出
```json
{
  "recommended_stocks": ["2330", "2454", "3034"],
  "reason": "台積電在AI晶片需求帶動下表現不錯，未來幾個月有望上漲",
  "sentiment": "positive",
  "sectors": ["半導體"],
  "strategy": "分批進場",
  "risk_level": "low"
}
```

### 分析維度
1. **推薦股票**: 自動識別台股、美股、港股代碼
2. **推薦原因**: 基於文章內容生成簡潔的投資理由
3. **情感傾向**: positive/negative/neutral
4. **相關產業**: 識別文章涉及的產業類別
5. **投資策略**: 分析作者的投資策略類型
6. **風險等級**: 評估投資風險 (low/medium/high)

## 使用方式

### 1. 啟動 Ollama 服務
```bash
ollama serve
```

### 2. 下載模型
```bash
ollama pull qwen2.5:0.5b
```

### 3. 運行分析
```python
from article_analyzer import ArticleAnalyzer

analyzer = ArticleAnalyzer()
result = analyzer.analyze_article(article_id)
```

## 配置說明

### 環境要求
- Python 3.13+
- Ollama 服務運行中
- Qwen2.5:0.5b 模型已下載

### 依賴包
```
ollama==0.4.2
```

## 錯誤處理

### 1. 模型不可用
- 自動回退到規則式分析
- 記錄錯誤日誌
- 返回預設分析結果

### 2. JSON 解析失敗
- 嘗試提取 JSON 部分
- 使用預設值作為備用
- 記錄警告日誌

## 性能優化

### 1. 模型參數
- `temperature: 0.3` - 降低隨機性，提高一致性
- `top_p: 0.9` - 平衡創造性和準確性

### 2. 內容截斷
- 限制輸入內容為 2000 字符
- 避免過長的提示詞影響性能

## 測試結果

### 測試案例
```
標題: [標的] 台積電(2330) 多
內容: 台積電最近在 AI 晶片需求帶動下，股價表現不錯...
```

### 分析結果
- **推薦股票**: 2330, 2454, 3034
- **推薦原因**: 台積電在AI晶片需求帶動下表現不錯，未來幾個月有望上漲
- **情感傾向**: positive
- **相關產業**: 半導體
- **投資策略**: 分批進場
- **風險等級**: low

## 未來改進

1. **模型升級**: 可考慮使用更大的模型提高分析準確性
2. **提示詞優化**: 根據實際使用情況調整分析提示詞
3. **緩存機制**: 對相同文章的分析結果進行緩存
4. **批量分析**: 支持批量文章分析以提高效率

## 注意事項

1. 確保 Ollama 服務持續運行
2. 定期檢查模型狀態
3. 監控分析結果的準確性
4. 根據需要調整模型參數
